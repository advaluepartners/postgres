2025/06/29 20:01:41 [INFO] Packer version: 1.12.0 [go1.22.9 darwin arm64]
2025/06/29 20:01:41 [INFO] PACKER_CONFIG env var not set; checking the default config file path
2025/06/29 20:01:41 [INFO] PACKER_CONFIG env var set; attempting to open config file: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 [WARN] Config file doesn't exist: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 [INFO] Setting cache directory: /Users/barneycook/.cache/packer
2025/06/29 20:01:41 [TRACE] listing potential installations for "github.com/hashicorp/amazon" that match ">= 0.0.2". plugingetter.ListInstallationsOptions{PluginDirectory:"/Users/barneycook/.config/packer/plugins", BinaryInstallationOptions:plugingetter.BinaryInstallationOptions{APIVersionMajor:"5", APIVersionMinor:"0", OS:"darwin", ARCH:"arm64", Ext:"", Checksummers:[]plugingetter.Checksummer{plugingetter.Checksummer{Type:"sha256", Hash:(*sha256.digest)(0x140001d8180)}}, ReleasesOnly:false}}
2025/06/29 20:01:41 [TRACE] Found the following "github.com/hashicorp/amazon" installations: [{/Users/barneycook/.config/packer/plugins/github.com/hashicorp/amazon/packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 v1.3.4 x5.0}]
2025/06/29 20:01:41 [INFO] found external [chroot ebs ebssurrogate ebsvolume instance] builders from amazon plugin
2025/06/29 20:01:41 [INFO] found external [import] post-processors from amazon plugin
2025/06/29 20:01:41 found external [ami parameterstore secretsmanager] datasource from amazon plugin
2025/06/29 20:01:41 plugin "/Users/barneycook/.config/packer/plugins/github.com/hashicorp/amazon/packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64" does not support Protobuf, forcing use of Gob
2025/06/29 20:01:41 [TRACE] listing potential installations for <nil> that match "". plugingetter.ListInstallationsOptions{PluginDirectory:"/Users/barneycook/.config/packer/plugins", BinaryInstallationOptions:plugingetter.BinaryInstallationOptions{APIVersionMajor:"5", APIVersionMinor:"0", OS:"darwin", ARCH:"arm64", Ext:"", Checksummers:[]plugingetter.Checksummer{plugingetter.Checksummer{Type:"sha256", Hash:(*sha256.digest)(0x140001d9000)}}, ReleasesOnly:false}}
2025/06/29 20:01:41 [INFO] found external [chroot ebs ebssurrogate ebsvolume instance] builders from amazon plugin
2025/06/29 20:01:41 [INFO] found external [import] post-processors from amazon plugin
2025/06/29 20:01:41 found external [ami parameterstore secretsmanager] datasource from amazon plugin
2025/06/29 20:01:41 [TRACE] validateValue: not active for force-deregister, so skipping
2025/06/29 20:01:41 [TRACE] validateValue: not active for git_sha, so skipping
2025/06/29 20:01:41 [TRACE] validateValue: not active for profile, so skipping
2025/06/29 20:01:41 [TRACE] validateValue: not active for git-head-version, so skipping
2025/06/29 20:01:41 [TRACE] validateValue: not active for postgres_major_version, so skipping
2025/06/29 20:01:41 [TRACE] validateValue: not active for git_commit_sha, so skipping
2025/06/29 20:01:41 [TRACE] validateValue: not active for postgres-version, so skipping
2025/06/29 20:01:41 [TRACE] validateValue: not active for packer-execution-id, so skipping
2025/06/29 20:01:41 [TRACE] validateValue: not active for ami_regions, so skipping
2025/06/29 20:01:41 [TRACE] validateValue: not active for environment, so skipping
2025/06/29 20:01:41 [TRACE] validateValue: not active for region, so skipping
2025/06/29 20:01:41 [TRACE] validateValue: not active for ami_name, so skipping
2025/06/29 20:01:41 [INFO] Starting external plugin /Users/barneycook/.config/packer/plugins/github.com/hashicorp/amazon/packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 start builder ebs
2025/06/29 20:01:41 Starting plugin: /Users/barneycook/.config/packer/plugins/github.com/hashicorp/amazon/packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 []string{"/Users/barneycook/.config/packer/plugins/github.com/hashicorp/amazon/packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64", "start", "builder", "ebs"}
2025/06/29 20:01:41 Waiting for RPC address for: /Users/barneycook/.config/packer/plugins/github.com/hashicorp/amazon/packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64
2025/06/29 20:01:41 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:01:41 Plugin address: unix /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin2116283037
2025/06/29 20:01:41 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:01:41 Waiting for connection...
2025/06/29 20:01:41 Received unix RPC address for /Users/barneycook/.config/packer/plugins/github.com/hashicorp/amazon/packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64: addr is /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin2116283037
2025/06/29 20:01:41 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:01:41 Serving a plugin connection...
2025/06/29 20:01:41 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:01:41 [TRACE] starting builder ebs
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:01:41 [INFO] (aws): No AWS timeout and polling overrides have been set. Packer will default to waiter-specific delays and timeouts. If you would like to customize the length of time between retries and max number of retries you may do so by setting the environment variables AWS_POLL_DELAY_SECONDS and AWS_MAX_ATTEMPTS or the configuration options aws_polling_delay_seconds and aws_polling_max_attempts to your desired values.
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 [INFO] Starting external plugin /opt/homebrew/bin/packer execute packer-provisioner-shell
2025/06/29 20:01:41 Starting plugin: /opt/homebrew/bin/packer []string{"/opt/homebrew/bin/packer", "execute", "packer-provisioner-shell"}
2025/06/29 20:01:41 Waiting for RPC address for: /opt/homebrew/bin/packer
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] Packer version: 1.12.0 [go1.22.9 darwin arm64]
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-shell plugin: [WARN] Config file doesn't exist: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] Setting cache directory: /Users/barneycook/.cache/packer
2025/06/29 20:01:41 packer-provisioner-shell plugin: Plugin address: unix /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin1218497144
2025/06/29 20:01:41 packer-provisioner-shell plugin: Waiting for connection...
2025/06/29 20:01:41 Received unix RPC address for /opt/homebrew/bin/packer: addr is /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin1218497144
2025/06/29 20:01:41 packer-provisioner-shell plugin: Serving a plugin connection...
2025/06/29 20:01:41 packer-provisioner-shell plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 packer-provisioner-shell plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 [INFO] Starting external plugin /opt/homebrew/bin/packer execute packer-provisioner-shell
2025/06/29 20:01:41 Starting plugin: /opt/homebrew/bin/packer []string{"/opt/homebrew/bin/packer", "execute", "packer-provisioner-shell"}
2025/06/29 20:01:41 Waiting for RPC address for: /opt/homebrew/bin/packer
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] Packer version: 1.12.0 [go1.22.9 darwin arm64]
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-shell plugin: [WARN] Config file doesn't exist: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] Setting cache directory: /Users/barneycook/.cache/packer
2025/06/29 20:01:41 packer-provisioner-shell plugin: Plugin address: unix /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin1634347317
2025/06/29 20:01:41 packer-provisioner-shell plugin: Waiting for connection...
2025/06/29 20:01:41 Received unix RPC address for /opt/homebrew/bin/packer: addr is /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin1634347317
2025/06/29 20:01:41 packer-provisioner-shell plugin: Serving a plugin connection...
2025/06/29 20:01:41 packer-provisioner-shell plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 packer-provisioner-shell plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 [INFO] Starting external plugin /opt/homebrew/bin/packer execute packer-provisioner-file
2025/06/29 20:01:41 Starting plugin: /opt/homebrew/bin/packer []string{"/opt/homebrew/bin/packer", "execute", "packer-provisioner-file"}
2025/06/29 20:01:41 Waiting for RPC address for: /opt/homebrew/bin/packer
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Packer version: 1.12.0 [go1.22.9 darwin arm64]
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [WARN] Config file doesn't exist: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Setting cache directory: /Users/barneycook/.cache/packer
2025/06/29 20:01:41 packer-provisioner-file plugin: Plugin address: unix /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin1525489040
2025/06/29 20:01:41 packer-provisioner-file plugin: Waiting for connection...
2025/06/29 20:01:41 Received unix RPC address for /opt/homebrew/bin/packer: addr is /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin1525489040
2025/06/29 20:01:41 packer-provisioner-file plugin: Serving a plugin connection...
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 [INFO] Starting external plugin /opt/homebrew/bin/packer execute packer-provisioner-file
2025/06/29 20:01:41 Starting plugin: /opt/homebrew/bin/packer []string{"/opt/homebrew/bin/packer", "execute", "packer-provisioner-file"}
2025/06/29 20:01:41 Waiting for RPC address for: /opt/homebrew/bin/packer
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Packer version: 1.12.0 [go1.22.9 darwin arm64]
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [WARN] Config file doesn't exist: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Setting cache directory: /Users/barneycook/.cache/packer
2025/06/29 20:01:41 packer-provisioner-file plugin: Plugin address: unix /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin2775171832
2025/06/29 20:01:41 packer-provisioner-file plugin: Waiting for connection...
2025/06/29 20:01:41 Received unix RPC address for /opt/homebrew/bin/packer: addr is /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin2775171832
2025/06/29 20:01:41 packer-provisioner-file plugin: Serving a plugin connection...
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 [INFO] Starting external plugin /opt/homebrew/bin/packer execute packer-provisioner-file
2025/06/29 20:01:41 Starting plugin: /opt/homebrew/bin/packer []string{"/opt/homebrew/bin/packer", "execute", "packer-provisioner-file"}
2025/06/29 20:01:41 Waiting for RPC address for: /opt/homebrew/bin/packer
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Packer version: 1.12.0 [go1.22.9 darwin arm64]
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [WARN] Config file doesn't exist: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Setting cache directory: /Users/barneycook/.cache/packer
2025/06/29 20:01:41 Received unix RPC address for /opt/homebrew/bin/packer: addr is /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin2960120873
2025/06/29 20:01:41 packer-provisioner-file plugin: Plugin address: unix /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin2960120873
2025/06/29 20:01:41 packer-provisioner-file plugin: Waiting for connection...
2025/06/29 20:01:41 packer-provisioner-file plugin: Serving a plugin connection...
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 [INFO] Starting external plugin /opt/homebrew/bin/packer execute packer-provisioner-file
2025/06/29 20:01:41 Starting plugin: /opt/homebrew/bin/packer []string{"/opt/homebrew/bin/packer", "execute", "packer-provisioner-file"}
2025/06/29 20:01:41 Waiting for RPC address for: /opt/homebrew/bin/packer
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Packer version: 1.12.0 [go1.22.9 darwin arm64]
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [WARN] Config file doesn't exist: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Setting cache directory: /Users/barneycook/.cache/packer
2025/06/29 20:01:41 packer-provisioner-file plugin: Plugin address: unix /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin3494373718
2025/06/29 20:01:41 packer-provisioner-file plugin: Waiting for connection...
2025/06/29 20:01:41 Received unix RPC address for /opt/homebrew/bin/packer: addr is /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin3494373718
2025/06/29 20:01:41 packer-provisioner-file plugin: Serving a plugin connection...
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 [INFO] Starting external plugin /opt/homebrew/bin/packer execute packer-provisioner-file
2025/06/29 20:01:41 Starting plugin: /opt/homebrew/bin/packer []string{"/opt/homebrew/bin/packer", "execute", "packer-provisioner-file"}
2025/06/29 20:01:41 Waiting for RPC address for: /opt/homebrew/bin/packer
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Packer version: 1.12.0 [go1.22.9 darwin arm64]
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [WARN] Config file doesn't exist: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Setting cache directory: /Users/barneycook/.cache/packer
2025/06/29 20:01:41 Received unix RPC address for /opt/homebrew/bin/packer: addr is /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin3588847387
2025/06/29 20:01:41 packer-provisioner-file plugin: Plugin address: unix /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin3588847387
2025/06/29 20:01:41 packer-provisioner-file plugin: Waiting for connection...
2025/06/29 20:01:41 packer-provisioner-file plugin: Serving a plugin connection...
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 [INFO] Starting external plugin /opt/homebrew/bin/packer execute packer-provisioner-file
2025/06/29 20:01:41 Starting plugin: /opt/homebrew/bin/packer []string{"/opt/homebrew/bin/packer", "execute", "packer-provisioner-file"}
2025/06/29 20:01:41 Waiting for RPC address for: /opt/homebrew/bin/packer
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Packer version: 1.12.0 [go1.22.9 darwin arm64]
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [WARN] Config file doesn't exist: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Setting cache directory: /Users/barneycook/.cache/packer
2025/06/29 20:01:41 packer-provisioner-file plugin: Plugin address: unix /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin1336000469
2025/06/29 20:01:41 packer-provisioner-file plugin: Waiting for connection...
2025/06/29 20:01:41 Received unix RPC address for /opt/homebrew/bin/packer: addr is /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin1336000469
2025/06/29 20:01:41 packer-provisioner-file plugin: Serving a plugin connection...
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 [INFO] Starting external plugin /opt/homebrew/bin/packer execute packer-provisioner-file
2025/06/29 20:01:41 Starting plugin: /opt/homebrew/bin/packer []string{"/opt/homebrew/bin/packer", "execute", "packer-provisioner-file"}
2025/06/29 20:01:41 Waiting for RPC address for: /opt/homebrew/bin/packer
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Packer version: 1.12.0 [go1.22.9 darwin arm64]
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [WARN] Config file doesn't exist: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-file plugin: [INFO] Setting cache directory: /Users/barneycook/.cache/packer
2025/06/29 20:01:41 Received unix RPC address for /opt/homebrew/bin/packer: addr is /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin738628267
2025/06/29 20:01:41 packer-provisioner-file plugin: Plugin address: unix /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin738628267
2025/06/29 20:01:41 packer-provisioner-file plugin: Waiting for connection...
2025/06/29 20:01:41 packer-provisioner-file plugin: Serving a plugin connection...
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 packer-provisioner-file plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 [INFO] Starting external plugin /opt/homebrew/bin/packer execute packer-provisioner-shell
2025/06/29 20:01:41 Starting plugin: /opt/homebrew/bin/packer []string{"/opt/homebrew/bin/packer", "execute", "packer-provisioner-shell"}
2025/06/29 20:01:41 Waiting for RPC address for: /opt/homebrew/bin/packer
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] Packer version: 1.12.0 [go1.22.9 darwin arm64]
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] PACKER_CONFIG env var not set; checking the default config file path
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] PACKER_CONFIG env var set; attempting to open config file: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-shell plugin: [WARN] Config file doesn't exist: /Users/barneycook/.packerconfig
2025/06/29 20:01:41 packer-provisioner-shell plugin: [INFO] Setting cache directory: /Users/barneycook/.cache/packer
2025/06/29 20:01:41 Received unix RPC address for /opt/homebrew/bin/packer: addr is /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin154120000
2025/06/29 20:01:41 packer-provisioner-shell plugin: Plugin address: unix /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-plugin154120000
2025/06/29 20:01:41 packer-provisioner-shell plugin: Waiting for connection...
2025/06/29 20:01:41 packer-provisioner-shell plugin: Serving a plugin connection...
2025/06/29 20:01:41 packer-provisioner-shell plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 packer-provisioner-shell plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:01:41 [DEBUG] - common: receiving ConfigSpec as gob
2025/06/29 20:01:41 Build debug mode: false
2025/06/29 20:01:41 Force build: true
2025/06/29 20:01:41 On error: 
2025/06/29 20:01:41 Waiting on builds to complete...
[1;32mnix-packer-ubuntu.amazon-ebs.ubuntu: output will be in this color.[0m

2025/06/29 20:01:41 Starting build run: nix-packer-ubuntu.amazon-ebs.ubuntu
2025/06/29 20:01:41 Running builder: amazon-ebs
2025/06/29 20:01:41 [INFO] (telemetry) Starting builder amazon-ebs.ubuntu
2025/06/29 20:01:41 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:01:41 [INFO] AWS Auth provider used: "SharedCredentialsProvider"
2025/06/29 20:01:41 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:01:41 Found region us-east-1
2025/06/29 20:01:41 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:01:41 [INFO] AWS Auth provider used: "SharedCredentialsProvider"
[1;32m2025-06-29T20:01:42+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Force Deregister flag found, skipping prevalidating AMI Name[0m
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:01:42 Using AMI Filters {
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:   Filters: [{
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:       Name: "name",
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:       Values: ["capitala-project-ami-15.8-stage-1"]
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:     },{
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:       Name: "root-device-type",
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:       Values: ["ebs"]
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:     },{
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:       Name: "virtualization-type",
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:       Values: ["hvm"]
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:     }],
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:   IncludeDeprecated: false,
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin:   Owners: ["amazon","self"]
2025/06/29 20:01:42 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: }
[0;32m2025-06-29T20:01:42+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Found Image ID: ami-0857098bba6a95bde[0m
[1;32m2025-06-29T20:01:42+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Setting public IP address to true on instance without a subnet ID[0m
[1;32m2025-06-29T20:01:42+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: No VPC ID provided, Packer will use the default VPC[0m
[1;32m2025-06-29T20:01:43+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Inferring subnet from the selected VPC "vpc-0ba07cf7a36d288ba"[0m
[1;32m2025-06-29T20:01:46+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Set subnet as "subnet-0fb5ab63f221bfd4f"[0m
[1;32m2025-06-29T20:01:46+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Creating temporary keypair: packer_68618d95-3925-544d-b26b-625ed9145c69[0m
[1;32m2025-06-29T20:01:46+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Creating temporary security group for this instance: packer_68618d9a-119b-6b1c-520c-8bf66647d054[0m
2025/06/29 20:01:47 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:01:47 [DEBUG] Waiting for temporary security group: sg-0338296e1e097b45c
2025/06/29 20:01:48 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:01:48 [DEBUG] Found security group sg-0338296e1e097b45c
[1;32m2025-06-29T20:01:48+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Authorizing access to port 22 from [0.0.0.0/0] in the temporary security groups...[0m
[1;32m2025-06-29T20:01:48+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Launching a source AWS instance...[0m
[0;32m2025-06-29T20:01:48+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Adding tag: "creator": "packer"[0m
[0;32m2025-06-29T20:01:48+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Adding tag: "packerExecutionId": "1751223701"[0m
[0;32m2025-06-29T20:01:48+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Adding tag: "appType": "postgres"[0m
[0;32m2025-06-29T20:01:48+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Adding tag: "appType": "postgres"[0m
[0;32m2025-06-29T20:01:48+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Adding tag: "creator": "packer"[0m
[1;32m2025-06-29T20:01:48+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: changing public IP address config to true for instance on subnet "subnet-0fb5ab63f221bfd4f"[0m
[0;32m2025-06-29T20:01:50+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Instance ID: i-0964c2303e26fa362[0m
[1;32m2025-06-29T20:01:50+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Waiting for instance (i-0964c2303e26fa362) to become ready...[0m
2025/06/29 20:02:06 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:06 [INFO] Not using winrm communicator, skipping get password...
[1;32m2025-06-29T20:02:06+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Using SSH communicator to connect: 44.222.98.162[0m
2025/06/29 20:02:06 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:06 [INFO] Waiting for SSH, up to timeout: 15m0s
[1;32m2025-06-29T20:02:06+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Waiting for SSH to become available...[0m
2025/06/29 20:02:06 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:06 Using host value: 44.222.98.162
2025/06/29 20:02:06 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:06 [INFO] Attempting SSH connection to 44.222.98.162:22...
2025/06/29 20:02:06 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:06 [DEBUG] reconnecting to TCP connection for SSH
2025/06/29 20:02:06 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:06 [DEBUG] handshaking with SSH
2025/06/29 20:02:07 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:07 [DEBUG] handshake complete!
2025/06/29 20:02:07 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:07 [DEBUG] Opening new ssh session
2025/06/29 20:02:07 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:07 [INFO] agent forwarding enabled
[1;32m2025-06-29T20:02:07+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Connected to SSH![0m
2025/06/29 20:02:07 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:07 Running the provision hook
2025/06/29 20:02:07 [INFO] (telemetry) Starting provisioner shell
2025/06/29 20:02:07 packer-provisioner-shell plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:02:07 [DEBUG] - common: receiving ConfigSpec as gob
[1;32m2025-06-29T20:02:07+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Provisioning with shell script: /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-shell2015956846[0m
2025/06/29 20:02:07 packer-provisioner-shell plugin: Opening /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-shell2015956846 for reading
2025/06/29 20:02:07 packer-provisioner-shell plugin: [INFO] 516 bytes written for 'uploadData'
2025/06/29 20:02:07 [INFO] 516 bytes written for 'uploadData'
2025/06/29 20:02:07 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:07 [DEBUG] Opening new ssh session
2025/06/29 20:02:07 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:07 [DEBUG] Starting remote scp process:  scp -vt /tmp
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] Started SCP session, beginning transfers...
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] Copying input data into temporary file so we can read the length
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] scp: Uploading script_4913.sh: perms=C0644 size=516
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] SCP session complete, closing stdin pipe.
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] Waiting for SSH session to complete.
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] scp stderr (length 31): Sink: C0644 516 script_4913.sh
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] Opening new ssh session
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] starting remote command: chmod 0755 /tmp/script_4913.sh
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [INFO] RPC endpoint: Communicator ended with: 0
2025/06/29 20:02:08 [INFO] RPC client: Communicator ended with: 0
2025/06/29 20:02:08 [INFO] RPC endpoint: Communicator ended with: 0
2025/06/29 20:02:08 packer-provisioner-shell plugin: [INFO] RPC client: Communicator ended with: 0
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] Opening new ssh session
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] starting remote command: chmod +x /tmp/script_4913.sh; PACKER_BUILDER_TYPE='amazon-ebs' PACKER_BUILD_NAME='ubuntu'  /tmp/script_4913.sh
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: === Diagnostic: All block devices ===[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: NAME               SIZE TYPE MOUNTPOINT[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: nvme0n1     10737418240 disk[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: ├─nvme0n1p1   103809024 part /boot/efi[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: └─nvme0n1p2 10631512064 part /[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: nvme2n1     64424509440 disk[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: nvme3n1      8589934592 disk /data[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: nvme1n1     21474836480 disk[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: === Diagnostic: NVMe devices ===[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: crw------- 1 root root 238, 0 Jun 29 19:01 /dev/nvme0[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: brw-rw---- 1 root disk 259, 0 Jun 29 19:01 /dev/nvme0n1[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: brw-rw---- 1 root disk 259, 4 Jun 29 19:01 /dev/nvme0n1p1[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: brw-rw---- 1 root disk 259, 5 Jun 29 19:01 /dev/nvme0n1p2[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: crw------- 1 root root 238, 1 Jun 29 19:01 /dev/nvme1[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: brw-rw---- 1 root disk 259, 3 Jun 29 19:01 /dev/nvme1n1[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: crw------- 1 root root 238, 2 Jun 29 19:01 /dev/nvme2[0m
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [INFO] RPC endpoint: Communicator ended with: 0
2025/06/29 20:02:08 [INFO] 1704 bytes written for 'stdout'
2025/06/29 20:02:08 [INFO] 0 bytes written for 'stderr'
2025/06/29 20:02:08 [INFO] RPC client: Communicator ended with: 0
2025/06/29 20:02:08 [INFO] RPC endpoint: Communicator ended with: 0
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: brw-rw---- 1 root disk 259, 1 Jun 29 19:01 /dev/nvme2n1[0m
2025/06/29 20:02:08 packer-provisioner-shell plugin: [INFO] 0 bytes written for 'stderr'
2025/06/29 20:02:08 packer-provisioner-shell plugin: [INFO] 1704 bytes written for 'stdout'
2025/06/29 20:02:08 packer-provisioner-shell plugin: [INFO] RPC client: Communicator ended with: 0
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: crw------- 1 root root 238, 3 Jun 29 19:01 /dev/nvme3[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: brw-rw---- 1 root disk 259, 2 Jun 29 19:01 /dev/nvme3n1[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: === Diagnostic: Current mounts ===[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: /dev/nvme0n1p2 on / type ext4 (rw,relatime,discard)[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: /dev/nvme3n1 on /data type ext4 (rw,relatime,discard)[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: === Diagnostic: Disk usage ===[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Filesystem      Size  Used Avail Use% Mounted on[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: udev            3.8G     0  3.8G   0% /dev[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: tmpfs           778M  636K  777M   1% /run[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: /dev/nvme0n1p2  9.7G  1.9G  7.8G  20% /[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: tmpfs           3.8G     0  3.8G   0% /dev/shm[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: tmpfs           5.0M     0  5.0M   0% /run/lock[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: tmpfs           3.8G     0  3.8G   0% /sys/fs/cgroup[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: /dev/nvme3n1    7.8G   28K  7.7G   1% /data[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: /dev/nvme0n1p1   98M  298K   98M   1% /boot/efi[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: tmpfs           778M     0  778M   0% /run/user/1000[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: === Diagnostic: Find large volumes ===[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Device /dev/nvme0n1 is 10[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: 0[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: 9GB[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Device /dev/nvme1n1 is 20GB[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Device /dev/nvme2n1 is 60GB[0m
[0;32m2025-06-29T20:02:08+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: Device /dev/nvme3n1 is 8GB[0m
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] Opening new ssh session
2025/06/29 20:02:08 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:08 [DEBUG] starting remote command: rm -f /tmp/script_4913.sh
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [INFO] RPC endpoint: Communicator ended with: 0
2025/06/29 20:02:09 [INFO] RPC client: Communicator ended with: 0
2025/06/29 20:02:09 [INFO] RPC endpoint: Communicator ended with: 0
2025/06/29 20:02:09 packer-provisioner-shell plugin: [INFO] RPC client: Communicator ended with: 0
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] Opening new ssh session
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] starting remote command: rm -f
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [INFO] RPC endpoint: Communicator ended with: 0
2025/06/29 20:02:09 [INFO] RPC client: Communicator ended with: 0
2025/06/29 20:02:09 [INFO] RPC endpoint: Communicator ended with: 0
2025/06/29 20:02:09 packer-provisioner-shell plugin: [INFO] RPC client: Communicator ended with: 0
2025/06/29 20:02:09 [INFO] (telemetry) ending shell
2025/06/29 20:02:09 [INFO] (telemetry) Starting provisioner shell
2025/06/29 20:02:09 packer-provisioner-shell plugin: [DEBUG] - common: sending ConfigSpec as gob
2025/06/29 20:02:09 [DEBUG] - common: receiving ConfigSpec as gob
[1;32m2025-06-29T20:02:09+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Provisioning with shell script: /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-shell36658102[0m
2025/06/29 20:02:09 packer-provisioner-shell plugin: Opening /var/folders/60/djqdr1sn5x5dmwllvmnlf3dc0000gn/T/packer-shell36658102 for reading
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] Opening new ssh session
2025/06/29 20:02:09 packer-provisioner-shell plugin: [INFO] 2103 bytes written for 'uploadData'
2025/06/29 20:02:09 [INFO] 2103 bytes written for 'uploadData'
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] Starting remote scp process:  scp -vt /tmp
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] Started SCP session, beginning transfers...
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] Copying input data into temporary file so we can read the length
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] scp: Uploading script_7932.sh: perms=C0644 size=2103
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] SCP session complete, closing stdin pipe.
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] Waiting for SSH session to complete.
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] scp stderr (length 32): Sink: C0644 2103 script_7932.sh
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] Opening new ssh session
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] starting remote command: chmod 0755 /tmp/script_7932.sh
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [INFO] RPC endpoint: Communicator ended with: 0
2025/06/29 20:02:09 [INFO] RPC client: Communicator ended with: 0
2025/06/29 20:02:09 [INFO] RPC endpoint: Communicator ended with: 0
2025/06/29 20:02:09 packer-provisioner-shell plugin: [INFO] RPC client: Communicator ended with: 0
2025/06/29 20:02:09 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:09 [DEBUG] Opening new ssh session
2025/06/29 20:02:10 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:10 [DEBUG] starting remote command: chmod +x /tmp/script_7932.sh; PACKER_BUILDER_TYPE='amazon-ebs' PACKER_BUILD_NAME='ubuntu'  /tmp/script_7932.sh
[0;32m2025-06-29T20:02:10+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: === Setting up 60GB build volume for Nix ===[0m
2025/06/29 20:02:10 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:10 [ERROR] Remote command exited with '2': chmod +x /tmp/script_7932.sh; PACKER_BUILDER_TYPE='amazon-ebs' PACKER_BUILD_NAME='ubuntu'  /tmp/script_7932.sh
2025/06/29 20:02:10 packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64 plugin: 2025/06/29 20:02:10 [INFO] RPC endpoint: Communicator ended with: 2
2025/06/29 20:02:10 [INFO] 126 bytes written for 'stdout'
2025/06/29 20:02:10 [INFO] 0 bytes written for 'stderr'
2025/06/29 20:02:10 [INFO] RPC client: Communicator ended with: 2
2025/06/29 20:02:10 [INFO] RPC endpoint: Communicator ended with: 2
2025/06/29 20:02:10 packer-provisioner-shell plugin: [INFO] 126 bytes written for 'stdout'
2025/06/29 20:02:10 packer-provisioner-shell plugin: [INFO] 0 bytes written for 'stderr'
2025/06/29 20:02:10 packer-provisioner-shell plugin: [INFO] RPC client: Communicator ended with: 2
[0;32m2025-06-29T20:02:10+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: /tmp/script_7932.sh: 15: Illegal number: 10737418240[0m
[0;32m2025-06-29T20:02:10+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu:   103809024[0m
[0;32m2025-06-29T20:02:10+01:00:     nix-packer-ubuntu.amazon-ebs.ubuntu: 10631512064[0m
2025/06/29 20:02:10 [INFO] (telemetry) ending shell
[1;32m2025-06-29T20:02:10+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Provisioning step had errors: Running the cleanup provisioner, if present...[0m
[1;32m2025-06-29T20:02:10+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Terminating the source AWS instance...[0m
[1;32m2025-06-29T20:02:57+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Cleaning up any extra volumes...[0m
[1;32m2025-06-29T20:02:58+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: No volumes to clean up, skipping[0m
[1;32m2025-06-29T20:02:58+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Deleting temporary security group...[0m
[1;32m2025-06-29T20:02:58+01:00: ==> nix-packer-ubuntu.amazon-ebs.ubuntu: Deleting temporary keypair...[0m
2025/06/29 20:02:59 [INFO] (telemetry) ending amazon-ebs.ubuntu
[1;31m2025-06-29T20:02:59+01:00: Build 'nix-packer-ubuntu.amazon-ebs.ubuntu' errored after 1 minute 17 seconds: Script exited with non-zero exit status: 2. Allowed exit codes are: [0][0m

==> Wait completed after 1 minute 17 seconds
==> Wait completed after 1 minute 17 seconds

==> Some builds didn't complete successfully and had errors:
2025/06/29 20:02:59 machine readable: error-count []string{"1"}
==> Some builds didn't complete successfully and had errors:
--> nix-packer-ubuntu.amazon-ebs.ubuntu: Script exited with non-zero exit status: 2. Allowed exit codes are: [0]
2025/06/29 20:02:59 machine readable: nix-packer-ubuntu.amazon-ebs.ubuntu,error []string{"Script exited with non-zero exit status: 2. Allowed exit codes are: [0]"}

==> Builds finished but no artifacts were created.
==> Builds finished but no artifacts were created.
2025/06/29 20:02:59 [INFO] (telemetry) Finalizing.
2025/06/29 20:03:00 waiting for all plugin processes to complete...
2025/06/29 20:03:00 /opt/homebrew/bin/packer: plugin process exited
2025/06/29 20:03:00 /opt/homebrew/bin/packer: plugin process exited
2025/06/29 20:03:00 /opt/homebrew/bin/packer: plugin process exited
2025/06/29 20:03:00 /opt/homebrew/bin/packer: plugin process exited
2025/06/29 20:03:00 /opt/homebrew/bin/packer: plugin process exited
2025/06/29 20:03:00 /Users/barneycook/.config/packer/plugins/github.com/hashicorp/amazon/packer-plugin-amazon_v1.3.4_x5.0_darwin_arm64: plugin process exited
2025/06/29 20:03:00 /opt/homebrew/bin/packer: plugin process exited
2025/06/29 20:03:00 /opt/homebrew/bin/packer: plugin process exited
2025/06/29 20:03:00 /opt/homebrew/bin/packer: plugin process exited
2025/06/29 20:03:00 /opt/homebrew/bin/packer: plugin process exited
2025/06/29 20:03:00 /opt/homebrew/bin/packer: plugin process exited
