[Unit]
Description=nginx server
After=network.target docker.service postgrest.service gotrue.service adminapi.service
Wants=docker.service postgrest.service gotrue.service adminapi.service
Requires=docker.service

[Service]
Type=forking
PIDFile=/usr/local/nginx/logs/nginx.pid
ExecStartPre=/usr/local/nginx/sbin/nginx -t -c /etc/nginx/nginx.conf
ExecStart=/usr/local/nginx/sbin/nginx -c /etc/nginx/nginx.conf
ExecReload=/usr/local/nginx/sbin/nginx -s reload -c /etc/nginx/nginx.conf
ExecStop=/usr/local/nginx/sbin/nginx -s quit
# Removed User=nginx - nginx will start as root and drop privileges internally
Slice=services.slice
Restart=always
RestartSec=5
LimitNOFILE=100000
AmbientCapabilities=CAP_NET_BIND_SERVICE

[Install]
WantedBy=multi-user.target
